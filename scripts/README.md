# scripts

This directory contains the analytic scripts comprising the backbone of the manuscript.
If you read something in the manuscript and have a question about the methodology or implementation. chances are you can find the answer in one of these files.

## 01_preprocess

These scripts were used to preprocess the neuroimaging data obtained from the PPMI.
We have included all the [data](../data) required to run these scripts; however, if you're insistent on regenerating everything from scratch you [can do that, too](../walkthrough)!

- [`01_parcellate_antslct.py`](./01_preprocess/01_parcellate_antslct.py): 
We processed all the PPMI neuroimaging data with a [slightly modified](https://github.com/rmarkello/antslct/) version of the [ANTs longitudinal cortical thickness pipeline](https://www.biorxiv.org/content/10.1101/170209v2).
This script parcellates the outputs of that pipeline, generating cortical thickness and subcortical volume measurements that are used as the primary neuroimaging features in the SNF workflows.
- [`02_get_pdica_zscore.py`](./01_preprocess/02_get_pdica_zscore.py):
This script uses the PD-ICA "biomarker" (developed by [Zeighami and colleagues](https://doi.org/10.7554/eLife.08440)) to generate a single "PD-ICA score" for each PD patient.

You can run these scripts from the root of the repository using `make preprocess`.

## 02_analysis

These scripts make up the main data wrangling and similarity network fusion workflows.
They take all the "raw" data and run them through SNF and whatnot to generate outputs on which we can conduct various statistical assessments.

- [`01_preprare_snf_data.py`](./02_analysis/01_prepare_snf_data.py):
This script takes all the disparate data modalities (neuroimaging data, clinical-behavioral assessments, dopamine transported binding data, and cerebrospinal fluid assays), does a bit of wrangling / cleaning (i.e., dropping subjects that don't have sufficient data in all modalities), and performs some batch correction / residualization.
- [`02_snf_gridsearch.py`](./02_analysis/02_snf_gridsearch.py):
This script actually runs the giant SNF gridsearch on the PPMI data.

You can run these scripts from the root of the repository using `make analysis`.


## 03_results

These scripts use the outputs of the analytic workflows, above, to actually generate "results" (in scare quotes because the outputs of the above scripts are arguably *also* results&mdash;technicalities, schmechnicalities).
Numerical results reported in the associated manuscript are computed with these files, and running these files will (read: should) re-generate all relevant figures (which will be saved to the [`figures`](../figures) directory).

- [`01_concatenation_vs_snf.py`](./03_results/01_concatenation_vs_snf.py):
This script generates results and figures used to compare SNF with data concatenation.
- [`02_pd_patient_biotypes.py`](./03_results/02_pd_patient_biotypes.py):
This script generates results and figures used to investigate the PD patient clustering solution generated by SNF.
- [`03_mri_contributions.py`](./03_results/03_mri_contributions.py):
This script generates results and figures used to assess the impact of neuroimaging data on PD patient clustering solutions generated with SNF.
- [`04_diffusion_embedding.py`](./03_results/04_diffusion_embedding.py):
This script generates results and figures used to investigate a diffusion map embedding of the PD patient similarity network.
- [`05_supplementary_results.py`](./03_results/05_supplementary_results.py):
This script generates results and figures used to support supplementary analyses demonstrating the "robustness" of the primary results.
- [`analyis.py`](./03_results/analysis.py):
Contains codebits and functions supporting various analyses in the above results-generating scripts.

You can run these scripts from the root of the repository using `make results`.
